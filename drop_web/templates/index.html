<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.title}}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    animation: {
                        'pulse-soft': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-soft': 'bounce 1s infinite',
                        'wave': 'wave 1.5s ease-in-out infinite',
                    },
                    keyframes: {
                        wave: {
                            '0%, 100%': { transform: 'scaleY(1)' },
                            '50%': { transform: 'scaleY(1.5)' }
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body class="bg-gray-900 text-gray-100 font-sans">
    <!-- Header -->
    <header class="bg-gray-800 border-b border-gray-700 px-6 py-4 shadow-lg">
        <div class="flex items-center justify-between">
            <h1 class="text-2xl font-bold text-white flex items-center gap-3">
                ğŸ¤– <span class="bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">NaLa Coder</span>
            </h1>
            <div class="hidden md:flex items-center gap-4">
                <div id="sessionInfo" class="text-sm text-gray-400">æ–°ä¼šè¯</div>
                <div class="flex gap-2">
                    <button id="streamToggle" class="toggle-btn bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors">
                        æµå¼å“åº”
                    </button>
                    <button id="sidebarToggle" class="toggle-btn bg-gray-700 text-gray-300 px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-gray-600 transition-colors">
                        æ˜¾ç¤ºä¾§è¾¹æ 
                    </button>
                </div>
            </div>
        </div>
        <div id="projectPath" class="mt-3 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 flex items-center gap-3">
            <span class="text-gray-400 font-medium text-sm flex-shrink-0">ğŸ“ é¡¹ç›®è·¯å¾„:</span>
            <code class="bg-gray-800 text-blue-400 px-2 py-1 rounded text-xs font-mono border border-gray-600 overflow-hidden text-ellipsis whitespace-nowrap flex-1" title="{{.projectPath}}">{{.projectPath}}</code>
        </div>
    </header>

    <!-- Main Container -->
    <div class="flex-1 flex overflow-hidden">
        <!-- Left Sidebar - File Browser -->
        <div id="fileBrowserPanel" class="w-80 bg-gray-800 border-r border-gray-700 flex flex-col transition-all duration-300 ease-in-out">
            <div class="flex items-center justify-between px-4 py-3 bg-gray-750 border-b border-gray-700">
                <h3 class="text-sm font-semibold text-gray-200 flex items-center gap-2">
                    ğŸ“ æ–‡ä»¶æµè§ˆå™¨
                </h3>
                <button id="fileBrowserToggle" class="p-1 hover:bg-gray-600 rounded text-gray-400 hover:text-white transition-colors" title="æ”¶èµ·/å±•å¼€">
                    ğŸ“Œ
                </button>
            </div>
            <div class="flex-1 flex flex-col p-4 gap-3 overflow-hidden">
                <div class="flex items-center gap-2 px-3 py-2 bg-gray-700 rounded-lg border border-gray-600">
                    <button id="refreshTreeBtn" class="p-1 hover:bg-gray-600 rounded text-gray-400 hover:text-white transition-colors" title="åˆ·æ–°ç›®å½•æ ‘">
                        ğŸ”„
                    </button>
                    <span id="currentPath" class="text-xs text-gray-400 font-mono flex-1 overflow-hidden text-ellipsis whitespace-nowrap">åŠ è½½ä¸­...</span>
                </div>
                <div id="fileTree" class="flex-1 bg-gray-700 border border-gray-600 rounded-lg p-3 overflow-y-auto text-sm">
                    <div class="text-gray-400 text-center py-8">åŠ è½½ç›®å½•ç»“æ„ä¸­...</div>
                </div>
            </div>
        </div>

        <!-- Center Content Area -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- File Viewer -->
            <div id="fileViewer" class="hidden bg-gray-800 border-b border-gray-700 h-64 flex flex-col">
                <div class="flex items-center justify-between px-4 py-3 bg-gray-750 border-b border-gray-700">
                    <div class="flex flex-col gap-1">
                        <span id="fileName" class="text-sm font-semibold text-gray-200">æ–‡ä»¶å</span>
                        <span id="fileMeta" class="text-xs text-gray-400">å¤§å° | ä¿®æ”¹æ—¶é—´</span>
                    </div>
                    <button id="closeFileBtn" class="p-1 hover:bg-gray-600 rounded text-gray-400 hover:text-white transition-colors" title="å…³é—­æ–‡ä»¶">
                        âœ•
                    </button>
                </div>
                <div id="fileContent" class="flex-1 overflow-auto bg-gray-900">
                    <pre class="p-4 text-sm"><code id="fileCode" class="text-gray-300 font-mono"></code></pre>
                </div>
            </div>

            <!-- Chat Section -->
            <div id="chatSection" class="flex-1 flex flex-col bg-gray-800">
                <div id="chatContainer" class="flex-1 overflow-y-auto p-6 space-y-4">
                    <!-- System Welcome Message -->
                    <div class="flex flex-col max-w-4xl">
                        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-xl shadow-lg border border-gray-600">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-2xl">ğŸ¤–</span>
                                <strong class="text-lg">NaLa Coder</strong>
                            </div>
                            <div class="text-gray-100 leading-relaxed">
                                ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„AIç¼–ç¨‹åŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ ï¼š<br>
                                â€¢ ğŸ› ï¸ å„ç§å¼€å‘ä»»åŠ¡ã€€â€¢ ğŸ” æœç´¢ä»£ç ã€€â€¢ ğŸ’» æ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>
                                â€¢ ä½ å¯ä»¥è¯´"å°åŠ©æ‰‹"æ¥å”¤èµ·æˆ‘ï¼Œç„¶åå‘Šè¯‰æˆ‘ä½ è¦åšä»€ä¹ˆã€‚
                            </div>
                        </div>
                        <div class="text-xs text-gray-500 mt-2">ç³»ç»Ÿæ¶ˆæ¯</div>
                    </div>
                </div>
                
                <!-- Input Section -->
                <div class="border-t border-gray-700 bg-gray-750 p-4">
                    <div class="flex items-end gap-3 max-w-4xl mx-auto">
                        <div class="flex-1 relative">
                            <textarea 
                                id="messageInput" 
                                class="w-full bg-gray-700 text-gray-100 border border-gray-600 rounded-xl px-4 py-3 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent placeholder-gray-400" 
                                placeholder="è¾“å…¥ä½ çš„æ¶ˆæ¯..." 
                                rows="1"
                            ></textarea>
                        </div>
                        
                        <!-- Voice Button -->
                        <div class="voice-button-container relative">
                            <button id="voiceButton" class="voice-button w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white rounded-full flex items-center justify-center transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500" title="è¯­éŸ³è¾“å…¥">
                                <span class="text-lg">ğŸ¤</span>
                                <div class="voice-waves absolute inset-0 hidden">
                                    <div class="wave w-1 bg-white rounded-full mx-auto"></div>
                                    <div class="wave w-1 bg-white rounded-full mx-auto"></div>
                                    <div class="wave w-1 bg-white rounded-full mx-auto"></div>
                                    <div class="wave w-1 bg-white rounded-full mx-auto"></div>
                                    <div class="wave w-1 bg-white rounded-full mx-auto"></div>
                                </div>
                            </button>
                        </div>
                        
                        <button id="sendButton" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
                            å‘é€
                        </button>
                    </div>
                    
                    <!-- Voice Status -->
                    <div id="voiceStatus" class="hidden mt-3 flex items-center justify-center gap-2 text-sm text-gray-400">
                        <span id="voiceIndicator" class="text-red-500 animate-pulse">ğŸ”´</span>
                        <span id="voiceText">å‡†å¤‡ä¸­...</span>
                    </div>
                </div>
                
                <!-- Status Bar -->
                <div id="status" class="text-center text-xs text-gray-500 py-2 bg-gray-800 border-t border-gray-700">
                    å°±ç»ª
                </div>
            </div>
        </div>

        <!-- Right Sidebar -->
        <div id="sidebar" class="hidden w-72 bg-gray-800 border-l border-gray-700 flex flex-col">
            <!-- Session Management -->
            <div class="p-4 border-b border-gray-700">
                <h3 class="text-sm font-semibold text-gray-200 mb-3 flex items-center gap-2">
                    ğŸ“‹ ä¼šè¯ç®¡ç†
                </h3>
                <button id="newSessionBtn" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg text-sm font-medium transition-colors mb-3">
                    æ–°å»ºä¼šè¯
                </button>
                <div id="sessionsList" class="bg-gray-700 border border-gray-600 rounded-lg max-h-40 overflow-y-auto">
                    <div class="p-3 text-sm text-gray-400 text-center">æš‚æ— ä¼šè¯è®°å½•</div>
                </div>
            </div>

            <!-- Available Tools -->
            <div class="flex-1 p-4">
                <h3 class="text-sm font-semibold text-gray-200 mb-3 flex items-center gap-2">
                    ğŸ› ï¸ å¯ç”¨å·¥å…·
                </h3>
                <div id="toolsList" class="bg-gray-700 border border-gray-600 rounded-lg max-h-64 overflow-y-auto">
                    <div class="p-3 text-sm text-gray-400 text-center">åŠ è½½ä¸­...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/voice.js"></script>
    <script src="/static/js/main.js"></script>
</body>
</html>